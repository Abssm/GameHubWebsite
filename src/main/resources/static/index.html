<!DOCTYPE html>
<html lang="en" id="html-lang">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">Digital Game Store</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- AWS Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-mfizz/2.4.1/font-mfizz.min.css">
    <!-- Chart.js for analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #0d6efd;
            --secondary: #6c757d;
            --success: #198754;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #0dcaf0;
            --dark: #212529;
            --light: #f8f9fa;
            --purple: #6f42c1;
            --pink: #d63384;
            --teal: #20c997;
            --cyan: #0dcaf0;
            --gray: #6c757d;
            --gray-dark: #343a40;
            --primary-rgb: 13, 110, 253;
            --bs-primary-rgb: 13, 110, 253;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }
        
        .navbar {
            background: rgba(13, 13, 26, 0.95) !important;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 0 0 30px 30px;
        }
        
        .navbar-brand {
            font-weight: 800;
            font-size: 1.8rem;
            color: #ff0000 !important;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }
        
        .nav-link {
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 6px;
            margin: 0 4px;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .page-section {
            display: none;
            padding: 40px 0;
        }
        
        .page-section.active {
            display: block;
        }
        
        .hero-section {
            background: url('https://cdn.cloudflare.steamstatic.com/steam/apps/271590/header.jpg?t=1707254885') no-repeat center center;
            background-size: cover;
            padding: 120px 0;
            position: relative;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
        }
        
        .game-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            height: 100%;
        }
        
        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .game-card img {
            height: 200px;
            object-fit: cover;
            width: 100%;
        }
        
        .game-card .card-body {
            padding: 1.5rem;
        }
        
        .game-title {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .game-price {
            font-weight: 700;
            font-size: 1.3rem;
            color: #48dbfb;
        }
        
        .discount-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff0000;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: 700;
        }
        
        .btn-game {
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
            border: none;
            color: white;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .btn-game:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.4);
            color: white;
        }
        
        .section-title {
            font-weight: 700;
            margin-bottom: 2rem;
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
            border-radius: 2px;
        }
        
        .category-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .category-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #ff0000;
        }
        
        .category-count {
            color: #ffffff !important;
            font-weight: 600;
        }
        
        .footer {
            background: rgba(13, 13, 26, 0.95);
            padding: 40px 0;
            margin-top: 80px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .content-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 30px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .form-control {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        
        .form-control:focus {
            background: rgba(255, 255, 255, 0.15);
            border-color: #ff0000;
            box-shadow: 0 0 0 0.2rem rgba(255, 0, 0, 0.25);
            color: white;
        }
        
        .btn-login {
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
            border: none;
            color: white;
            font-weight: 600;
            padding: 12px;
            border-radius: 6px;
            width: 100%;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .btn-login:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.4);
        }
        
        .login-links {
            text-align: center;
            margin-top: 20px;
        }
        .login-links a {
            color: #ff0000;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .login-links a:hover {
            color: #ff6b6b;
        }
        
        .social-login {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .facebook { background: #3b5998; }
        .google { background: #db4437; }
        .twitter { background: #1da1f2; }
        
        .social-btn:hover {
            transform: translateY(-3px);
        }
        
        .featured-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: linear-gradient(90deg, #ff0000, #ff6b6b);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: 700;
            font-size: 0.8rem;
        }
        
        .game-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* New styles for detailed game view */
        .game-detail-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .game-detail-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .game-detail-img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .game-description {
            color: #b0b0b0;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        
        .game-meta {
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 10px;
        }
        
        .game-meta i {
            margin-right: 5px;
            color: #ff0000;
        }
        
        .filter-buttons {
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            margin: 5px;
        }
        
        .category-filter {
            position: sticky;
            top: 20px;
            z-index: 100;
        }
        
        /* Library styles */
        .library-section {
            margin-bottom: 30px;
        }
        
        .library-header {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .game-code {
            font-family: monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            margin: 5px 0;
        }
        
        .copy-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .purchased-badge {
            background: linear-gradient(90deg, #28a745, #20c997);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            margin-left: 10px;
        }
        
        .digital-code-badge {
            background: linear-gradient(90deg, #6f42c1, #9d72e3);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            margin-left: 10px;
        }
        
        @media (max-width: 768px) {
            .hero-section { padding: 80px 0; }
            .hero-content h1 { font-size: 2rem; }
            .game-card { margin-bottom: 20px; }
            .game-detail-img { height: 200px; }
        }
        
        .price-badge {
            background: rgba(13, 110, 253, 0.2);
            border: 1px solid rgba(13, 110, 253, 0.5);
            padding: 3px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        /* Admin Panel Styles */
        .admin-nav {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        .admin-nav .nav-link {
            color: #fff;
            border-radius: 5px;
            padding: 8px 15px;
            margin: 2px;
        }
        
        .admin-nav .nav-link.active {
            background: rgba(255, 0, 0, 0.3);
            border: 1px solid rgba(255, 0, 0, 0.5);
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .user-row {
            transition: all 0.3s ease;
        }
        
        .user-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .banned-badge {
            background: linear-gradient(90deg, #dc3545, #e35d6a);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        /* Cart Styles */
        .cart-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .cart-total {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        /* Payment Form Styles */
        .payment-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .card-preview {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            padding: 20px;
            color: white;
            height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .receipt {
            background: white;
            color: black;
            border-radius: 10px;
            padding: 25px;
            font-family: monospace;
        }
        
        /* RTL Support */
        body[dir="rtl"] {
            text-align: right;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body[dir="rtl"] .section-title::after {
            left: auto;
            right: 0;
        }
        
        body[dir="rtl"] .nav-link i,
        body[dir="rtl"] .dropdown-item i {
            margin-left: 5px;
            margin-right: 0;
        }
        
        /* Wishlist */
        .wishlist-btn {
            background: transparent;
            border: none;
            color: #ccc;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .wishlist-btn.active {
            color: #ff0000;
        }
        
        .wishlist-btn:hover {
            color: #ff0000;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showPage('home')">
                <i class="fas fa-gamepad me-2"></i><span id="nav-brand">GAMEHUB</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('home')"><i class="fas fa-home me-1"></i><span id="nav-home">Home</span></a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('games')"><i class="fas fa-gamepad me-1"></i><span id="nav-games">Games</span></a></li>
                    <li class="nav-item"><a class="nav-link" href="#" onclick="showPage('library')"><i class="fas fa-book me-1"></i><span id="nav-library">My Library</span></a></li>
                    <li class="nav-item admin-only" style="display: none;"><a class="nav-link" href="#" onclick="showPage('admin')"><i class="fas fa-cogs me-1"></i><span id="nav-admin">Admin Panel</span></a></li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown me-3">
                        <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown"><i class="fas fa-globe me-1"></i><span id="nav-language">Language</span></a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="changeLanguage('en')">English</a></li>
                            <li><a class="dropdown-item" href="#" onclick="changeLanguage('ar')">العربية (Arabic)</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown me-3">
                        <a class="nav-link dropdown-toggle" href="#" id="currencyDropdown" role="button" data-bs-toggle="dropdown"><i class="fas fa-money-bill-wave me-1"></i><span id="nav-currency">Currency</span></a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="changeCurrency('USD')">USD ($)</a></li>
                            <li><a class="dropdown-item" href="#" onclick="changeCurrency('SAR')">SAR (ر.س)</a></li>
                        </ul>
                    </li>
                    <li class="nav-item me-3">
                        <a class="nav-link position-relative" href="#" onclick="showPage('cart')">
                            <i class="fas fa-shopping-cart me-1"></i><span id="nav-cart">Cart</span>
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cart-count">0</span>
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="authDropdown" role="button" data-bs-toggle="dropdown"><i class="fas fa-user me-1"></i><span id="nav-account">Account</span></a>
                        <ul class="dropdown-menu">
                            <li id="login-menu-item"><a class="dropdown-item" href="#" onclick="showPage('login')"><i class="fas fa-sign-in-alt me-2"></i><span id="menu-login">Login</span></a></li>
                            <li id="register-menu-item"><a class="dropdown-item" href="#" onclick="showPage('register')"><i class="fas fa-user-plus me-2"></i><span id="menu-register">Register</span></a></li>
                            <li class="logged-in-only" style="display: none;"><hr class="dropdown-divider"></li>
                            <li class="logged-in-only" style="display: none;"><a class="dropdown-item" href="#" onclick="showPage('profile')"><i class="fas fa-user-circle me-2"></i><span id="menu-profile">Profile</span></a></li>
                            <li class="logged-in-only" style="display: none;"><a class="dropdown-item" href="#" onclick="showPage('wishlist')"><i class="fas fa-heart me-2"></i><span id="menu-wishlist">Wishlist</span></a></li>
                            <li class="logged-in-only" style="display: none;"><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i><span id="menu-logout">Logout</span></a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <section id="home" class="page-section active">
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="container hero-content">
                <div class="row align-items-center">
                    <div class="col-lg-6">
                        <h1 class="display-4 fw-bold mb-4" id="hero-title">Discover Your Next Favorite Game</h1>
                        <p class="lead mb-4" id="hero-subtitle">Explore thousands of games across all genres. From action-packed adventures to mind-bending puzzles.</p>
                        <div class="d-flex gap-3 flex-wrap">
                            <button class="btn btn-game btn-lg" onclick="showPage('games')" id="hero-browse-btn">Browse Games</button>
                            <button class="btn btn-outline-light btn-lg" id="hero-deals-btn">View Deals</button>
                        </div>
                    </div>
                    <div class="col-lg-6 text-center">
                        <div class="position-relative d-inline-block">
                            <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/271590/header.jpg?t=1707254885" alt="Featured Game" class="img-fluid rounded-3 shadow-lg" style="max-height: 400px;">
                            <div class="featured-badge" id="featured-badge-text">FEATURED</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Featured Games -->
        <div class="container py-5">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="section-title" id="featured-games-title">Featured Games</h2>
                <div class="btn-group">
                    <button class="btn btn-outline-light btn-sm active" onclick="loadGames('all')" id="filter-all">All</button>
                    <button class="btn btn-outline-light btn-sm" onclick="loadGames('FPS')" id="filter-fps">FPS</button>
                    <button class="btn btn-outline-light btn-sm" onclick="loadGames('RPG')" id="filter-rpg">RPG</button>
                </div>
            </div>
            <div class="row g-4" id="games-container">
                <!-- Games will be loaded here -->
            </div>
        </div>

        <!-- Categories -->
        <div class="container py-5">
            <h2 class="section-title" id="categories-title">Browse Categories</h2>
            <div class="row g-4">
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('FPS')">
                        <div class="category-icon"><i class="fas fa-crosshairs"></i></div>
                        <h5 id="cat-fps">FPS</h5><p class="category-count" id="count-fps">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('RPG')">
                        <div class="category-icon"><i class="fas fa-hat-wizard"></i></div>
                        <h5 id="cat-rpg">RPG</h5><p class="category-count" id="count-rpg">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('Action-Adventure')">
                        <div class="category-icon"><i class="fas fa-running"></i></div>
                        <h5 id="cat-action">Action-Adventure</h5><p class="category-count" id="count-action">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('MMO')">
                        <div class="category-icon"><i class="fas fa-users"></i></div>
                        <h5 id="cat-mmo">MMO</h5><p class="category-count" id="count-mmo">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('Arcade')">
                        <div class="category-icon"><i class="fas fa-gamepad"></i></div>
                        <h5 id="cat-arcade">Arcade</h5><p class="category-count" id="count-arcade">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('Racing')">
                        <div class="category-icon"><i class="fas fa-flag-checkered"></i></div>
                        <h5 id="cat-racing">Racing</h5><p class="category-count" id="count-racing">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('Sports')">
                        <div class="category-icon"><i class="fas fa-futbol"></i></div>
                        <h5 id="cat-sports">Sports</h5><p class="category-count" id="count-sports">Loading...</p>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="category-card" onclick="loadGames('Strategy')">
                        <div class="category-icon"><i class="fas fa-chess"></i></div>
                        <h5 id="cat-strategy">Strategy</h5><p class="category-count" id="count-strategy">Loading...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Games Page -->
    <section id="games" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="all-games-title">Browse All Games</h2>
            
            <!-- Filter Buttons -->
            <div class="d-flex flex-wrap gap-2 mb-4 filter-buttons">
                <button class="btn btn-outline-light filter-btn active" onclick="filterGames('all')" id="filter-all-games">All Games</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('FPS')" id="filter-games-fps">FPS</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('RPG')" id="filter-games-rpg">RPG</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('Action-Adventure')" id="filter-games-action">Action-Adventure</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('MMO')" id="filter-games-mmo">MMO</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('Arcade')" id="filter-games-arcade">Arcade</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('Racing')" id="filter-games-racing">Racing</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('Sports')" id="filter-games-sports">Sports</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('Strategy')" id="filter-games-strategy">Strategy</button>
                <button class="btn btn-outline-light filter-btn" onclick="filterGames('Horror')" id="filter-games-horror">Horror</button>
            </div>
            
            <!-- Search Bar -->
            <div class="input-group mb-4">
                <input type="text" class="form-control" placeholder="Search games by name..." id="gameSearch" onkeyup="searchGames()">
                <button class="btn btn-game" type="button" id="search-btn">Search</button>
            </div>
            
            <!-- Games Container -->
            <div class="row" id="all-games-container">
                <!-- All games will be loaded here -->
            </div>
        </div>
    </section>

    <!-- My Library Page -->
    <section id="library" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="library-title">My Game Library</h2>
            
            <!-- Login to see Library -->
            <div id="library-login" class="content-card text-center">
                <h4 class="text-white" id="library-login-title">Access Your Purchased Games & Digital Codes</h4>
                <p class="text-muted mb-4" id="library-login-subtitle">Enter your account email to view your library</p>
                <div class="d-flex justify-content-center">
                    <input type="email" id="lib-email" class="form-control w-50 me-2" placeholder="name@example.com">
                    <button onclick="loadLibrary()" class="btn btn-game" id="library-view-btn">View Library</button>
                </div>
                <div class="mt-3">
                    <p class="text-muted">Test with: demo@gamehub.com</p>
                </div>
            </div>

            <!-- Library Content (Hidden initially) -->
            <div id="library-content" style="display: none;">
                <button class="btn btn-outline-light mb-4" onclick="resetLibraryView()" id="library-back-btn">Back</button>
                
                <!-- Purchased Games Section -->
                <div class="library-section">
                    <div class="library-header">
                        <h4 class="mb-0"><i class="fas fa-gamepad me-2"></i><span id="library-games-title">Purchased Games</span> <span class="purchased-badge" id="purchased-count">0</span></h4>
                    </div>
                    <div class="row g-4" id="library-games">
                        <!-- Purchased games will be loaded here -->
                    </div>
                </div>
                
                <!-- Digital Codes Section -->
                <div class="library-section">
                    <div class="library-header">
                        <h4 class="mb-0"><i class="fas fa-gift me-2"></i><span id="library-codes-title">Digital Codes & Subscriptions</span> <span class="digital-code-badge" id="codes-count">0</span></h4>
                    </div>
                    <div class="row g-4" id="library-codes">
                        <!-- Digital codes will be loaded here -->
                    </div>
                </div>
                
                <!-- Purchase History -->
                <div class="library-section">
                    <div class="library-header">
                        <h4 class="mb-0"><i class="fas fa-history me-2"></i><span id="library-history-title">Purchase History</span></h4>
                    </div>
                    <div class="content-card">
                        <div class="table-responsive">
                            <table class="table table-dark table-hover">
                                <thead>
                                    <tr>
                                        <th id="history-date">Date</th>
                                        <th id="history-item">Item</th>
                                        <th id="history-type">Type</th>
                                        <th id="history-price">Price</th>
                                        <th id="history-status">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="purchase-history">
                                    <!-- Purchase history will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Panel -->
    <section id="admin" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="admin-title">Admin Panel</h2>
            
            <!-- Admin Login Check -->
            <div id="admin-login-check" class="content-card text-center">
                <h4 class="text-white">Admin Access Required</h4>
                <p class="text-muted mb-4">Please login with admin credentials to access this panel</p>
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="form-label">Admin Email</label>
                            <input type="email" id="admin-email" class="form-control" placeholder="Admin@gamehub.com">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Admin Password</label>
                            <input type="password" id="admin-password" class="form-control" placeholder="Admin@30">
                        </div>
                        <button onclick="adminLogin()" class="btn btn-game w-100">Login as Admin</button>
                    </div>
                </div>
            </div>
            
            <!-- Admin Panel Content (Hidden initially) -->
            <div id="admin-content" style="display: none;">
                <!-- Admin Navigation -->
                <div class="admin-nav">
                    <ul class="nav nav-pills">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" onclick="showAdminSection('analytics')" id="admin-analytics-btn"><i class="fas fa-chart-bar me-1"></i> Sales Analytics</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showAdminSection('games')" id="admin-games-btn"><i class="fas fa-gamepad me-1"></i> Game Management</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showAdminSection('users')" id="admin-users-btn"><i class="fas fa-users me-1"></i> User Management</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showAdminSection('settings')" id="admin-settings-btn"><i class="fas fa-cog me-1"></i> Settings</a>
                        </li>
                    </ul>
                </div>
                
                <!-- Analytics Section -->
                <div id="admin-analytics" class="admin-section">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="chart-container">
                                <h5 id="sales-chart-title">Sales Overview (Last 30 Days)</h5>
                                <canvas id="salesChart" height="200"></canvas>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="content-card">
                                <h5 id="stats-title">Quick Stats</h5>
                                <div class="mb-3">
                                    <h6 id="total-revenue">Total Revenue</h6>
                                    <h3 id="total-revenue-amount">$0.00</h3>
                                </div>
                                <div class="mb-3">
                                    <h6 id="total-orders">Total Orders</h6>
                                    <h3 id="total-orders-count">0</h3>
                                </div>
                                <div class="mb-3">
                                    <h6 id="total-users">Total Users</h6>
                                    <h3 id="total-users-count">0</h3>
                                </div>
                                <div class="mb-3">
                                    <h6 id="total-games">Total Games</h6>
                                    <h3 id="total-games-count">0</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="chart-container">
                                <h5 id="top-games-title">Top Selling Games</h5>
                                <table class="table table-dark">
                                    <thead>
                                        <tr>
                                            <th id="top-game">Game</th>
                                            <th id="top-sales">Sales</th>
                                            <th id="top-revenue">Revenue</th>
                                        </tr>
                                    </thead>
                                    <tbody id="top-games-list">
                                        <!-- Top games will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="chart-container">
                                <h5 id="recent-orders-title">Recent Orders</h5>
                                <table class="table table-dark">
                                    <thead>
                                        <tr>
                                            <th id="order-id">Order ID</th>
                                            <th id="order-user">User</th>
                                            <th id="order-amount">Amount</th>
                                            <th id="order-date">Date</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recent-orders-list">
                                        <!-- Recent orders will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Game Management Section -->
                <div id="admin-games" class="admin-section" style="display: none;">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="content-card">
                                <h5 id="add-game-title">Add New Game</h5>
                                <form id="add-game-form">
                                    <div class="mb-3">
                                        <label class="form-label" id="game-title-label">Game Title</label>
                                        <input type="text" class="form-control" id="new-game-title" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="game-category-label">Category</label>
                                        <select class="form-control" id="new-game-category" required>
                                            <option value="FPS">FPS</option>
                                            <option value="RPG">RPG</option>
                                            <option value="Action-Adventure">Action-Adventure</option>
                                            <option value="MMO">MMO</option>
                                            <option value="Arcade">Arcade</option>
                                            <option value="Racing">Racing</option>
                                            <option value="Sports">Sports</option>
                                            <option value="Strategy">Strategy</option>
                                            <option value="Horror">Horror</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="game-price-label">Price (USD)</label>
                                        <input type="number" class="form-control" id="new-game-price" step="0.01" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="game-image-label">Image URL</label>
                                        <input type="url" class="form-control" id="new-game-image" placeholder="https://example.com/image.jpg">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="game-description-label">Description</label>
                                        <textarea class="form-control" id="new-game-description" rows="3" required></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="game-developer-label">Developer</label>
                                        <input type="text" class="form-control" id="new-game-developer" required>
                                    </div>
                                    <button type="submit" class="btn btn-game w-100" id="add-game-btn">Add Game</button>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="content-card">
                                <h5 id="manage-games-title">Manage Existing Games</h5>
                                <div class="table-responsive">
                                    <table class="table table-dark">
                                        <thead>
                                            <tr>
                                                <th id="game-id">ID</th>
                                                <th id="game-name">Game Name</th>
                                                <th id="game-cat">Category</th>
                                                <th id="game-price-col">Price</th>
                                                <th id="game-actions">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="games-management-list">
                                            <!-- Games list will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- User Management Section -->
                <div id="admin-users" class="admin-section" style="display: none;">
                    <div class="content-card">
                        <h5 id="user-management-title">User Management</h5>
                        <div class="table-responsive">
                            <table class="table table-dark">
                                <thead>
                                    <tr>
                                        <th id="user-id">ID</th>
                                        <th id="user-email">Email</th>
                                        <th id="user-name">Name</th>
                                        <th id="user-join-date">Join Date</th>
                                        <th id="user-orders">Orders</th>
                                        <th id="user-total">Total Spent</th>
                                        <th id="user-status">Status</th>
                                        <th id="user-action">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="users-management-list">
                                    <!-- Users list will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div id="admin-settings" class="admin-section" style="display: none;">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="content-card">
                                <h5 id="site-settings-title">Site Settings</h5>
                                <form id="site-settings-form">
                                    <div class="mb-3">
                                        <label class="form-label" id="site-name-label">Site Name</label>
                                        <input type="text" class="form-control" id="site-name" value="GAMEHUB">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="default-currency-label">Default Currency</label>
                                        <select class="form-control" id="default-currency">
                                            <option value="USD">USD ($)</option>
                                            <option value="SAR">SAR (ر.س)</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="default-language-label">Default Language</label>
                                        <select class="form-control" id="default-language">
                                            <option value="en">English</option>
                                            <option value="ar">Arabic</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="tax-rate-label">Tax Rate (%)</label>
                                        <input type="number" class="form-control" id="tax-rate" value="15" min="0" max="100">
                                    </div>
                                    <div class="mb-3 form-check">
                                        <input type="checkbox" class="form-check-input" id="maintenance-mode">
                                        <label class="form-check-label" for="maintenance-mode" id="maintenance-label">Maintenance Mode</label>
                                    </div>
                                    <button type="submit" class="btn btn-game w-100" id="save-settings-btn">Save Settings</button>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="content-card">
                                <h5 id="payment-settings-title">Payment Settings</h5>
                                <form id="payment-settings-form">
                                    <div class="mb-3">
                                        <label class="form-label" id="payment-methods-label">Enabled Payment Methods</label>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="paypal-enabled" checked>
                                            <label class="form-check-label" for="paypal-enabled" id="paypal-label">PayPal</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="credit-card-enabled" checked>
                                            <label class="form-check-label" for="credit-card-enabled" id="credit-card-label">Credit/Debit Card</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="crypto-enabled">
                                            <label class="form-check-label" for="crypto-enabled" id="crypto-label">Cryptocurrency</label>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="min-purchase-label">Minimum Purchase Amount</label>
                                        <input type="number" class="form-control" id="min-purchase" value="5.00" step="0.01">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label" id="currency-rate-label">USD to SAR Rate</label>
                                        <input type="number" class="form-control" id="currency-rate" value="3.75" step="0.01">
                                    </div>
                                    <button type="submit" class="btn btn-game w-100" id="save-payment-btn">Save Payment Settings</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Page -->
    <section id="login" class="page-section">
        <div class="container py-5">
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <div class="content-card">
                        <h2 class="text-center mb-4" id="login-title">Login</h2>
                        <form id="loginForm">
                            <div class="mb-3">
                                <label class="form-label" id="login-email-label">Email</label>
                                <input type="email" class="form-control" id="login-email" placeholder="Enter email" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" id="login-password-label">Password</label>
                                <input type="password" class="form-control" id="login-password" placeholder="Enter password" required>
                            </div>
                            <button type="submit" class="btn btn-login" id="login-submit-btn">Login</button>
                        </form>
                        <div class="text-center mt-3">
                            <p class="text-muted">Or login with:</p>
                            <a href="/oauth2/authorization/cognito" class="btn btn-outline-primary">
                                <i class="icon-aws"></i> Login with Cognito
                            </a>
                        </div>
                        <div class="login-links">
                            <a href="#" onclick="showPage('register')" id="login-register-link">Don't have an account? Register</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Register Page -->
    <section id="register" class="page-section">
        <div class="container py-5">
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <div class="content-card">
                        <h2 class="text-center mb-4" id="register-title">Register</h2>
                        <form id="registerForm">
                            <div class="mb-3">
                                <label class="form-label" id="register-name-label">Full Name</label>
                                <input type="text" class="form-control" id="register-name" placeholder="Full Name" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" id="register-email-label">Email</label>
                                <input type="email" class="form-control" id="register-email" placeholder="Email" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" id="register-password-label">Password</label>
                                <input type="password" class="form-control" id="register-password" placeholder="Password" required minlength="6">
                            </div>
                            <div class="mb-3">
                                <label class="form-label" id="register-confirm-label">Confirm Password</label>
                                <input type="password" class="form-control" id="register-confirm" placeholder="Confirm Password" required>
                            </div>
                            <button type="submit" class="btn btn-login" id="register-submit-btn">Create Account</button>
                        </form>
                        <div class="text-center mt-3">
                            <p class="text-muted">Or sign up with:</p>
                            <a href="/oauth2/authorization/cognito" class="btn btn-outline-primary">
                                <i class="icon-aws"></i> Sign up with Cognito
                            </a>
                        </div>
                        <div class="login-links">
                            <a href="#" onclick="showPage('login')" id="register-login-link">Already have an account? Login</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Profile Page -->
    <section id="profile" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="profile-title">My Profile</h2>
            <div class="row">
                <div class="col-md-4">
                    <div class="content-card text-center">
                        <div class="mb-3">
                            <i class="fas fa-user-circle fa-5x text-primary"></i>
                        </div>
                        <h4 id="profile-name">John Doe</h4>
                        <p class="text-muted" id="profile-email">demo@gamehub.com</p>
                        <p id="profile-member-since">Member since: 2023</p>
                        <button class="btn btn-outline-light btn-sm mt-2" onclick="editProfile()" id="profile-edit-btn">Edit Profile</button>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="content-card">
                        <h5 id="profile-info-title">Account Information</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <strong id="profile-fullname-label">Full Name:</strong>
                                <p id="profile-fullname">John Doe</p>
                            </div>
                            <div class="col-md-6">
                                <strong id="profile-email-label">Email:</strong>
                                <p id="profile-email-value">demo@gamehub.com</p>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <strong id="profile-joindate-label">Join Date:</strong>
                                <p id="profile-joindate-value">January 15, 2023</p>
                            </div>
                            <div class="col-md-6">
                                <strong id="profile-totalorders-label">Total Orders:</strong>
                                <p id="profile-totalorders-value">3</p>
                            </div>
                        </div>
                        <hr>
                        <h5 id="profile-order-history">Order History</h5>
                        <div class="table-responsive">
                            <table class="table table-dark">
                                <thead>
                                    <tr>
                                        <th id="profile-order-id">Order ID</th>
                                        <th id="profile-order-date">Date</th>
                                        <th id="profile-order-items">Items</th>
                                        <th id="profile-order-total">Total</th>
                                        <th id="profile-order-status">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="profile-orders-list">
                                    <!-- Orders will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Wishlist Page -->
    <section id="wishlist" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="wishlist-title">My Wishlist</h2>
            <div id="wishlist-content">
                <div class="content-card" id="wishlist-empty" style="display: none;">
                    <h4 class="text-center text-muted" id="wishlist-empty-title">Your wishlist is empty</h4>
                    <p class="text-center" id="wishlist-empty-text">Add games to your wishlist by clicking the heart icon on any game</p>
                    <div class="text-center">
                        <button class="btn btn-game" onclick="showPage('games')" id="wishlist-browse-btn">Browse Games</button>
                    </div>
                </div>
                <div class="row g-4" id="wishlist-games">
                    <!-- Wishlist games will be loaded here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Cart Page -->
    <section id="cart" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="cart-title">Shopping Cart</h2>
            <div id="cart-empty" class="content-card text-center" style="display: none;">
                <h4 class="text-white" id="cart-empty-title">Your cart is empty</h4>
                <p class="text-muted mb-4" id="cart-empty-text">Add games to your cart to get started</p>
                <button class="btn btn-game" onclick="showPage('games')" id="cart-browse-btn">Browse Games</button>
            </div>
            
            <div id="cart-content" style="display: none;">
                <div class="row">
                    <div class="col-md-8">
                        <div id="cart-items-list">
                            <!-- Cart items will be loaded here -->
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="cart-total">
                            <h5 id="cart-summary-title">Order Summary</h5>
                            <div class="d-flex justify-content-between mb-2">
                                <span id="cart-subtotal-label">Subtotal:</span>
                                <span id="cart-subtotal">$0.00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span id="cart-tax-label">Tax (15%):</span>
                                <span id="cart-tax">$0.00</span>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between mb-3">
                                <strong id="cart-total-label">Total:</strong>
                                <strong id="cart-total">$0.00</strong>
                            </div>
                            <button class="btn btn-game w-100 mb-3" onclick="proceedToCheckout()" id="cart-checkout-btn">Proceed to Checkout</button>
                            <button class="btn btn-outline-light w-100" onclick="showPage('games')" id="cart-continue-btn">Continue Shopping</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Checkout Page -->
    <section id="checkout" class="page-section">
        <div class="container py-5">
            <h2 class="section-title" id="checkout-title">Checkout</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="payment-card">
                        <h5 id="payment-details-title">Payment Details</h5>
                        <form id="payment-form">
                            <div class="mb-3">
                                <label class="form-label" id="card-number-label">Card Number</label>
                                <input type="text" class="form-control" id="card-number" placeholder="1234 5678 9012 3456" maxlength="19" required>
                                <small class="text-muted" id="card-number-hint">12-16 digits required</small>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label" id="expiry-date-label">Expiry Date</label>
                                    <input type="text" class="form-control" id="expiry-date" placeholder="MM/YY" maxlength="5" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label" id="cvv-label">CVV</label>
                                    <input type="text" class="form-control" id="cvv" placeholder="123" maxlength="3" required>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" id="card-name-label">Cardholder Name</label>
                                <input type="text" class="form-control" id="card-name" placeholder="John Doe" required>
                            </div>
                            <button type="submit" class="btn btn-game w-100" id="payment-submit-btn">Complete Payment</button>
                        </form>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card-preview">
                        <div>
                            <i class="fas fa-credit-card fa-2x mb-3"></i>
                            <h5 id="card-preview-title">Virtual Payment Card</h5>
                        </div>
                        <div>
                            <h6 id="card-preview-number">**** **** **** ****</h6>
                            <div class="d-flex justify-content-between">
                                <span id="card-preview-name">CARDHOLDER NAME</span>
                                <span id="card-preview-expiry">MM/YY</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-card mt-4">
                        <h5 id="order-summary-title">Order Summary</h5>
                        <div id="checkout-items">
                            <!-- Checkout items will be loaded here -->
                        </div>
                        <div class="d-flex justify-content-between mt-3">
                            <strong id="order-total-label">Total:</strong>
                            <strong id="order-total">$0.00</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Payment Success Page -->
    <section id="payment-success" class="page-section">
        <div class="container py-5">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="content-card text-center">
                        <div class="mb-4">
                            <i class="fas fa-check-circle fa-5x text-success"></i>
                        </div>
                        <h3 id="payment-success-title">Payment Successful!</h3>
                        <p class="text-muted mb-4" id="payment-success-text">Thank you for your purchase. Your order has been confirmed.</p>
                        
                        <div class="receipt mb-4">
                            <h5 class="text-center" id="receipt-title">GAMEHUB - DIGITAL RECEIPT</h5>
                            <hr>
                            <div class="text-start">
                                <p><strong id="receipt-order-id">Order ID:</strong> <span id="receipt-order-id-value">#000000</span></p>
                                <p><strong id="receipt-date">Date:</strong> <span id="receipt-date-value">January 1, 2024</span></p>
                                <p><strong id="receipt-customer">Customer:</strong> <span id="receipt-customer-value">John Doe</span></p>
                                <hr>
                                <h6 id="receipt-items-title">Items:</h6>
                                <div id="receipt-items">
                                    <!-- Receipt items will be loaded here -->
                                </div>
                                <hr>
                                <div class="d-flex justify-content-between">
                                    <strong id="receipt-total-label">Total:</strong>
                                    <strong id="receipt-total-value">$0.00</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="game-code mb-4">
                            <h6 id="activation-title">Activation Instructions:</h6>
                            <p id="activation-text">Your game keys are now available in "My Library". You can also find them below:</p>
                            <div id="receipt-game-codes">
                                <!-- Game codes will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-center gap-3">
                            <button class="btn btn-game" onclick="showPage('library')" id="view-library-btn">View in Library</button>
                            <button class="btn btn-outline-light" onclick="showPage('home')" id="return-home-btn">Return to Home</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5><i class="fas fa-gamepad me-2"></i><span id="footer-brand">GAMEHUB</span></h5>
                    <p id="footer-desc">Your premier destination for digital games and subscriptions.</p>
                </div>
                <div class="col-md-4">
                    <h5 id="footer-links-title">Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" onclick="showPage('home')" class="text-light" id="footer-home-link">Home</a></li>
                        <li><a href="#" onclick="showPage('games')" class="text-light" id="footer-games-link">Games</a></li>
                        <li><a href="#" onclick="showPage('library')" class="text-light" id="footer-library-link">My Library</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5 id="footer-support-title">Support</h5>
                    <p id="footer-email">Email: support@gamehub.com</p>
                    <p id="footer-phone">Phone: +1 (555) 123-4567</p>
                </div>
            </div>
            <hr class="my-4">
            <p class="text-center text-muted" id="footer-copyright">© 2024 GameHub. All rights reserved.</p>
        </div>
    </footer>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ===================== GLOBAL VARIABLES =====================
        let currentUser = null;
        let currentCurrency = 'USD';
        let currentLanguage = 'en';
        let conversionRate = 3.75; // USD to SAR
        let cart = [];
        let wishlist = [];
        
        // Translation dictionaries
        const translations = {
            en: {
                // Navigation
                'nav-home': 'Home',
                'nav-games': 'Games',
                'nav-library': 'My Library',
                'nav-admin': 'Admin Panel',
                'nav-language': 'Language',
                'nav-currency': 'Currency',
                'nav-cart': 'Cart',
                'nav-account': 'Account',
                'menu-login': 'Login',
                'menu-register': 'Register',
                'menu-profile': 'Profile',
                'menu-wishlist': 'Wishlist',
                'menu-logout': 'Logout',
                
                // Home Page
                'hero-title': 'Discover Your Next Favorite Game',
                'hero-subtitle': 'Explore thousands of games across all genres. From action-packed adventures to mind-bending puzzles.',
                'hero-browse-btn': 'Browse Games',
                'hero-deals-btn': 'View Deals',
                'featured-badge-text': 'FEATURED',
                'featured-games-title': 'Featured Games',
                'filter-all': 'All',
                'filter-fps': 'FPS',
                'filter-rpg': 'RPG',
                'categories-title': 'Browse Categories',
                'cat-fps': 'FPS',
                'cat-rpg': 'RPG',
                'cat-action': 'Action-Adventure',
                'cat-mmo': 'MMO',
                'cat-arcade': 'Arcade',
                'cat-racing': 'Racing',
                'cat-sports': 'Sports',
                'cat-strategy': 'Strategy',
                
                // Games Page
                'all-games-title': 'Browse All Games',
                'filter-all-games': 'All Games',
                'filter-games-fps': 'FPS',
                'filter-games-rpg': 'RPG',
                'filter-games-action': 'Action-Adventure',
                'filter-games-mmo': 'MMO',
                'filter-games-arcade': 'Arcade',
                'filter-games-racing': 'Racing',
                'filter-games-sports': 'Sports',
                'filter-games-strategy': 'Strategy',
                'filter-games-horror': 'Horror',
                'search-btn': 'Search',
                
                // Library Page
                'library-title': 'My Game Library',
                'library-login-title': 'Access Your Purchased Games & Digital Codes',
                'library-login-subtitle': 'Enter your account email to view your library',
                'library-view-btn': 'View Library',
                'library-back-btn': 'Back',
                'library-games-title': 'Purchased Games',
                'library-codes-title': 'Digital Codes & Subscriptions',
                'library-history-title': 'Purchase History',
                'history-date': 'Date',
                'history-item': 'Item',
                'history-type': 'Type',
                'history-price': 'Price',
                'history-status': 'Status',
                
                // Admin Panel
                'admin-title': 'Admin Panel',
                'admin-analytics-btn': 'Sales Analytics',
                'admin-games-btn': 'Game Management',
                'admin-users-btn': 'User Management',
                'admin-settings-btn': 'Settings',
                'sales-chart-title': 'Sales Overview (Last 30 Days)',
                'stats-title': 'Quick Stats',
                'total-revenue': 'Total Revenue',
                'total-orders': 'Total Orders',
                'total-users': 'Total Users',
                'total-games': 'Total Games',
                'top-games-title': 'Top Selling Games',
                'top-game': 'Game',
                'top-sales': 'Sales',
                'top-revenue': 'Revenue',
                'recent-orders-title': 'Recent Orders',
                'order-id': 'Order ID',
                'order-user': 'User',
                'order-amount': 'Amount',
                'order-date': 'Date',
                'add-game-title': 'Add New Game',
                'game-title-label': 'Game Title',
                'game-category-label': 'Category',
                'game-price-label': 'Price (USD)',
                'game-image-label': 'Image URL',
                'game-description-label': 'Description',
                'game-developer-label': 'Developer',
                'add-game-btn': 'Add Game',
                'manage-games-title': 'Manage Existing Games',
                'game-id': 'ID',
                'game-name': 'Game Name',
                'game-cat': 'Category',
                'game-price-col': 'Price',
                'game-actions': 'Actions',
                'user-management-title': 'User Management',
                'user-id': 'ID',
                'user-email': 'Email',
                'user-name': 'Name',
                'user-join-date': 'Join Date',
                'user-orders': 'Orders',
                'user-total': 'Total Spent',
                'user-status': 'Status',
                'user-action': 'Actions',
                'site-settings-title': 'Site Settings',
                'site-name-label': 'Site Name',
                'default-currency-label': 'Default Currency',
                'default-language-label': 'Default Language',
                'tax-rate-label': 'Tax Rate (%)',
                'maintenance-label': 'Maintenance Mode',
                'save-settings-btn': 'Save Settings',
                'payment-settings-title': 'Payment Settings',
                'payment-methods-label': 'Enabled Payment Methods',
                'paypal-label': 'PayPal',
                'credit-card-label': 'Credit/Debit Card',
                'crypto-label': 'Cryptocurrency',
                'min-purchase-label': 'Minimum Purchase Amount',
                'currency-rate-label': 'USD to SAR Rate',
                'save-payment-btn': 'Save Payment Settings',
                
                // Login/Register
                'login-title': 'Login',
                'login-email-label': 'Email',
                'login-password-label': 'Password',
                'login-submit-btn': 'Login',
                'login-register-link': 'Don\'t have an account? Register',
                'register-title': 'Register',
                'register-name-label': 'Full Name',
                'register-email-label': 'Email',
                'register-password-label': 'Password',
                'register-confirm-label': 'Confirm Password',
                'register-submit-btn': 'Create Account',
                'register-login-link': 'Already have an account? Login',
                
                // Profile
                'profile-title': 'My Profile',
                'profile-edit-btn': 'Edit Profile',
                'profile-info-title': 'Account Information',
                'profile-fullname-label': 'Full Name:',
                'profile-email-label': 'Email:',
                'profile-joindate-label': 'Join Date:',
                'profile-totalorders-label': 'Total Orders:',
                'profile-order-history': 'Order History',
                'profile-order-id': 'Order ID',
                'profile-order-date': 'Date',
                'profile-order-items': 'Items',
                'profile-order-total': 'Total',
                'profile-order-status': 'Status',
                
                // Wishlist
                'wishlist-title': 'My Wishlist',
                'wishlist-empty-title': 'Your wishlist is empty',
                'wishlist-empty-text': 'Add games to your wishlist by clicking the heart icon on any game',
                'wishlist-browse-btn': 'Browse Games',
                
                // Cart
                'cart-title': 'Shopping Cart',
                'cart-empty-title': 'Your cart is empty',
                'cart-empty-text': 'Add games to your cart to get started',
                'cart-browse-btn': 'Browse Games',
                'cart-summary-title': 'Order Summary',
                'cart-subtotal-label': 'Subtotal:',
                'cart-tax-label': 'Tax (15%):',
                'cart-total-label': 'Total:',
                'cart-checkout-btn': 'Proceed to Checkout',
                'cart-continue-btn': 'Continue Shopping',
                
                // Checkout
                'checkout-title': 'Checkout',
                'payment-details-title': 'Payment Details',
                'card-number-label': 'Card Number',
                'card-number-hint': '12-16 digits required',
                'expiry-date-label': 'Expiry Date',
                'cvv-label': 'CVV',
                'card-name-label': 'Cardholder Name',
                'payment-submit-btn': 'Complete Payment',
                'card-preview-title': 'Virtual Payment Card',
                'order-summary-title': 'Order Summary',
                'order-total-label': 'Total:',
                
                // Payment Success
                'payment-success-title': 'Payment Successful!',
                'payment-success-text': 'Thank you for your purchase. Your order has been confirmed.',
                'receipt-title': 'GAMEHUB - DIGITAL RECEIPT',
                'receipt-order-id': 'Order ID:',
                'receipt-date': 'Date:',
                'receipt-customer': 'Customer:',
                'receipt-items-title': 'Items:',
                'receipt-total-label': 'Total:',
                'activation-title': 'Activation Instructions:',
                'activation-text': 'Your game keys are now available in "My Library". You can also find them below:',
                'view-library-btn': 'View in Library',
                'return-home-btn': 'Return to Home',
                
                // Footer
                'footer-brand': 'GAMEHUB',
                'footer-desc': 'Your premier destination for digital games and subscriptions.',
                'footer-links-title': 'Quick Links',
                'footer-home-link': 'Home',
                'footer-games-link': 'Games',
                'footer-library-link': 'My Library',
                'footer-support-title': 'Support',
                'footer-email': 'Email: support@gamehub.com',
                'footer-phone': 'Phone: +1 (555) 123-4567',
                'footer-copyright': '© 2024 GameHub. All rights reserved.',
                
                // Common
                'remove': 'Remove',
                'edit': 'Edit',
                'delete': 'Delete',
                'save': 'Save',
                'cancel': 'Cancel',
                'view': 'View',
                'ban': 'Ban',
                'unban': 'Unban',
                'download': 'Download',
                'copy': 'Copy',
                'redeem': 'Redeem'
            },
            ar: {
                // Navigation
                'nav-home': 'الرئيسية',
                'nav-games': 'الألعاب',
                'nav-library': 'مكتبتي',
                'nav-admin': 'لوحة التحكم',
                'nav-language': 'اللغة',
                'nav-currency': 'العملة',
                'nav-cart': 'عربة التسوق',
                'nav-account': 'الحساب',
                'menu-login': 'تسجيل الدخول',
                'menu-register': 'تسجيل',
                'menu-profile': 'الملف الشخصي',
                'menu-wishlist': 'قائمة الرغبات',
                'menu-logout': 'تسجيل الخروج',
                
                // Home Page
                'hero-title': 'اكتشف لعبتك المفضلة القادمة',
                'hero-subtitle': 'استكشف الآلاف من الألعاب عبر جميع الأنواع. من مغامرات مليئة بالإثارة إلى الألغاز المحيرة للعقل.',
                'hero-browse-btn': 'تصفح الألعاب',
                'hero-deals-btn': 'عرض العروض',
                'featured-badge-text': 'مميز',
                'featured-games-title': 'الألعاب المميزة',
                'filter-all': 'الكل',
                'filter-fps': 'إطلاق النار',
                'filter-rpg': 'أدوار',
                'categories-title': 'تصفح الفئات',
                'cat-fps': 'إطلاق النار',
                'cat-rpg': 'أدوار',
                'cat-action': 'مغامرة-حركة',
                'cat-mmo': 'متعددة اللاعبين',
                'cat-arcade': 'أركيد',
                'cat-racing': 'سباق',
                'cat-sports': 'رياضة',
                'cat-strategy': 'إستراتيجية',
                
                // Games Page
                'all-games-title': 'تصفح جميع الألعاب',
                'filter-all-games': 'جميع الألعاب',
                'filter-games-fps': 'إطلاق النار',
                'filter-games-rpg': 'أدوار',
                'filter-games-action': 'مغامرة-حركة',
                'filter-games-mmo': 'متعددة اللاعبين',
                'filter-games-arcade': 'أركيد',
                'filter-games-racing': 'سباق',
                'filter-games-sports': 'رياضة',
                'filter-games-strategy': 'إستراتيجية',
                'filter-games-horror': 'رعب',
                'search-btn': 'بحث',
                
                // Library Page
                'library-title': 'مكتبتي',
                'library-login-title': 'الوصول إلى الألعاب المشتراة والرموز الرقمية',
                'library-login-subtitle': 'أدخل بريدك الإلكتروني لعرض مكتبتك',
                'library-view-btn': 'عرض المكتبة',
                'library-back-btn': 'رجوع',
                'library-games-title': 'الألعاب المشتراة',
                'library-codes-title': 'الرموز الرقمية والاشتراكات',
                'library-history-title': 'سجل المشتريات',
                'history-date': 'التاريخ',
                'history-item': 'العنصر',
                'history-type': 'النوع',
                'history-price': 'السعر',
                'history-status': 'الحالة',
                
                // Admin Panel
                'admin-title': 'لوحة التحكم',
                'admin-analytics-btn': 'تحليلات المبيعات',
                'admin-games-btn': 'إدارة الألعاب',
                'admin-users-btn': 'إدارة المستخدمين',
                'admin-settings-btn': 'الإعدادات',
                'sales-chart-title': 'نظرة عامة على المبيعات (آخر 30 يومًا)',
                'stats-title': 'إحصائيات سريعة',
                'total-revenue': 'إجمالي الإيرادات',
                'total-orders': 'إجمالي الطلبات',
                'total-users': 'إجمالي المستخدمين',
                'total-games': 'إجمالي الألعاب',
                'top-games-title': 'أكثر الألعاب مبيعًا',
                'top-game': 'اللعبة',
                'top-sales': 'المبيعات',
                'top-revenue': 'الإيرادات',
                'recent-orders-title': 'الطلبات الحديثة',
                'order-id': 'رقم الطلب',
                'order-user': 'المستخدم',
                'order-amount': 'المبلغ',
                'order-date': 'التاريخ',
                'add-game-title': 'إضافة لعبة جديدة',
                'game-title-label': 'اسم اللعبة',
                'game-category-label': 'الفئة',
                'game-price-label': 'السعر (دولار)',
                'game-image-label': 'رابط الصورة',
                'game-description-label': 'الوصف',
                'game-developer-label': 'المطور',
                'add-game-btn': 'إضافة لعبة',
                'manage-games-title': 'إدارة الألعاب الحالية',
                'game-id': 'الرقم',
                'game-name': 'اسم اللعبة',
                'game-cat': 'الفئة',
                'game-price-col': 'السعر',
                'game-actions': 'الإجراءات',
                'user-management-title': 'إدارة المستخدمين',
                'user-id': 'الرقم',
                'user-email': 'البريد الإلكتروني',
                'user-name': 'الاسم',
                'user-join-date': 'تاريخ الانضمام',
                'user-orders': 'الطلبات',
                'user-total': 'إجمالي الإنفاق',
                'user-status': 'الحالة',
                'user-action': 'الإجراءات',
                'site-settings-title': 'إعدادات الموقع',
                'site-name-label': 'اسم الموقع',
                'default-currency-label': 'العملة الافتراضية',
                'default-language-label': 'اللغة الافتراضية',
                'tax-rate-label': 'معدل الضريبة (%)',
                'maintenance-label': 'وضع الصيانة',
                'save-settings-btn': 'حفظ الإعدادات',
                'payment-settings-title': 'إعدادات الدفع',
                'payment-methods-label': 'طرق الدفع الممكنة',
                'paypal-label': 'PayPal',
                'credit-card-label': 'بطاقة ائتمان/خصم',
                'crypto-label': 'عملة مشفرة',
                'min-purchase-label': 'الحد الأدنى للشراء',
                'currency-rate-label': 'سعر الدولار إلى الريال',
                'save-payment-btn': 'حفظ إعدادات الدفع',
                
                // Login/Register
                'login-title': 'تسجيل الدخول',
                'login-email-label': 'البريد الإلكتروني',
                'login-password-label': 'كلمة المرور',
                'login-submit-btn': 'تسجيل الدخول',
                'login-register-link': 'ليس لديك حساب؟ سجل الآن',
                'register-title': 'تسجيل',
                'register-name-label': 'الاسم الكامل',
                'register-email-label': 'البريد الإلكتروني',
                'register-password-label': 'كلمة المرور',
                'register-confirm-label': 'تأكيد كلمة المرور',
                'register-submit-btn': 'إنشاء حساب',
                'register-login-link': 'لديك حساب بالفعل؟ سجل الدخول',
                
                // Profile
                'profile-title': 'ملفي الشخصي',
                'profile-edit-btn': 'تعديل الملف',
                'profile-info-title': 'معلومات الحساب',
                'profile-fullname-label': 'الاسم الكامل:',
                'profile-email-label': 'البريد الإلكتروني:',
                'profile-joindate-label': 'تاريخ الانضمام:',
                'profile-totalorders-label': 'إجمالي الطلبات:',
                'profile-order-history': 'سجل الطلبات',
                'profile-order-id': 'رقم الطلب',
                'profile-order-date': 'التاريخ',
                'profile-order-items': 'العناصر',
                'profile-order-total': 'الإجمالي',
                'profile-order-status': 'الحالة',
                
                // Wishlist
                'wishlist-title': 'قائمة رغباتي',
                'wishlist-empty-title': 'قائمة رغباتك فارغة',
                'wishlist-empty-text': 'أضف ألعابًا إلى قائمة رغباتك بالنقر على أيقونة القلب في أي لعبة',
                'wishlist-browse-btn': 'تصفح الألعاب',
                
                // Cart
                'cart-title': 'عربة التسوق',
                'cart-empty-title': 'عربة التسوق فارغة',
                'cart-empty-text': 'أضف ألعابًا إلى عربة التسوق للبدء',
                'cart-browse-btn': 'تصفح الألعاب',
                'cart-summary-title': 'ملخص الطلب',
                'cart-subtotal-label': 'المجموع الفرعي:',
                'cart-tax-label': 'الضريبة (15%):',
                'cart-total-label': 'الإجمالي:',
                'cart-checkout-btn': 'المتابعة للدفع',
                'cart-continue-btn': 'مواصلة التسوق',
                
                // Checkout
                'checkout-title': 'الدفع',
                'payment-details-title': 'تفاصيل الدفع',
                'card-number-label': 'رقم البطاقة',
                'card-number-hint': 'مطلوب 12-16 رقمًا',
                'expiry-date-label': 'تاريخ الانتهاء',
                'cvv-label': 'CVV',
                'card-name-label': 'اسم حامل البطاقة',
                'payment-submit-btn': 'إتمام الدفع',
                'card-preview-title': 'بطاقة الدفع الافتراضية',
                'order-summary-title': 'ملخص الطلب',
                'order-total-label': 'الإجمالي:',
                
                // Payment Success
                'payment-success-title': 'تم الدفع بنجاح!',
                'payment-success-text': 'شكرًا لك على شرائك. تم تأكيد طلبك.',
                'receipt-title': 'GAMEHUB - إيصال رقمي',
                'receipt-order-id': 'رقم الطلب:',
                'receipt-date': 'التاريخ:',
                'receipt-customer': 'العميل:',
                'receipt-items-title': 'العناصر:',
                'receipt-total-label': 'الإجمالي:',
                'activation-title': 'تعليمات التفعيل:',
                'activation-text': 'رموز ألعابك متاحة الآن في "مكتبتي". يمكنك أيضًا العثور عليها أدناه:',
                'view-library-btn': 'عرض في المكتبة',
                'return-home-btn': 'العودة للرئيسية',
                
                // Footer
                'footer-brand': 'GAMEHUB',
                'footer-desc': 'وجهتك المميزة للألعاب الرقمية والاشتراكات.',
                'footer-links-title': 'روابط سريعة',
                'footer-home-link': 'الرئيسية',
                'footer-games-link': 'الألعاب',
                'footer-library-link': 'مكتبتي',
                'footer-support-title': 'الدعم',
                'footer-email': 'البريد الإلكتروني: support@gamehub.com',
                'footer-phone': 'الهاتف: +1 (555) 123-4567',
                'footer-copyright': '© 2024 GameHub. جميع الحقوق محفوظة.',
                
                // Common
                'remove': 'إزالة',
                'edit': 'تعديل',
                'delete': 'حذف',
                'save': 'حفظ',
                'cancel': 'إلغاء',
                'view': 'عرض',
                'ban': 'حظر',
                'unban': 'إلغاء الحظر',
                'download': 'تحميل',
                'copy': 'نسخ',
                'redeem': 'استبدال'
            }
        };

        // ===================== DATABASE INITIALIZATION =====================
        // Comprehensive game database with 60+ real games
        const gameDatabase = [
            // FPS Games (25 games)
            {
                id: 1,
                title: "Counter-Strike 2",
                category: "FPS",
                priceUSD: 0.00,
                priceSAR: 0.00,
                imageUrl: "https://cdn.cloudflare.steamstatic.com/steam/apps/730/header.jpg",
                description: "Counter-Strike 2 is the largest technical leap forward in Counter-Strike's history, ensuring new features and updates for years to come.",
                releaseDate: "August 21, 2012",
                developer: "Valve",
                publisher: "Valve",
                rating: "9/10",
                platforms: ["Windows"],
                tags: ["Multiplayer", "Competitive", "Tactical"]
            },
            {
                id: 2,
                title: "Call of Duty: Modern Warfare II",
                category: "FPS",
                priceUSD: 69.99,
                priceSAR: 262.46,
                imageUrl: "https://cdn.cloudflare.steamstatic.com/steam/apps/1938090/header.jpg",
                description: "Call of Duty®: Modern Warfare® II drops players into an unprecedented global conflict that features the return of the iconic Operators of Task Force 141.",
                releaseDate: "October 28, 2022",
                developer: "Infinity Ward",
                publisher: "Activision",
                rating: "8/10",
                platforms: ["Windows", "PlayStation", "Xbox"],
                tags: ["Campaign", "Multiplayer", "Spec Ops"]
            },
            // ... (rest of game database remains the same as before)
            // For brevity, I'll include a few sample games
            {
                id: 41,
                title: "Grand Theft Auto V: Premium Edition & Whale Shark Card Bundle",
                category: "Action-Adventure",
                priceUSD: 59.99,
                priceSAR: 225.00,
                imageUrl: "https://cdn.cloudflare.steamstatic.com/steam/apps/271590/header.jpg",
                description: "Get the complete Grand Theft Auto V experience: the award-winning Story Mode and the massive, evolving world of Grand Theft Auto Online. This bundle includes the Criminal Enterprise Starter Pack (properties, vehicles, and weapons) plus the valuable Whale Shark Cash Card to instantly add GTA$3,500,000 to your online bank account, allowing you to instantly buy the best cars, weapons, and businesses.",
                releaseDate: "April 20, 2018",
                developer: "Rockstar North",
                publisher: "Rockstar Games",
                rating: "10/10",
                platforms: ["Windows", "PlayStation", "Xbox"],
                tags: ["Open World", "Crime", "Multiplayer", "Virtual Currency"]
            },
            {
                id: 42,
                title: "Red Dead Redemption 2",
                category: "Action-Adventure",
                priceUSD: 59.99,
                priceSAR: 225.00,
                imageUrl: "https://cdn.cloudflare.steamstatic.com/steam/apps/1174180/header.jpg",
                description: "Winner of over 175 Game of the Year Awards and recipient of over 250 perfect scores, Red Dead Redemption 2 is an epic tale of honor and loyalty at the dawn of the modern age.",
                releaseDate: "November 5, 2019",
                developer: "Rockstar Studios",
                publisher: "Rockstar Games",
                rating: "10/10",
                platforms: ["Windows", "PlayStation", "Xbox"],
                tags: ["Western", "Open World", "Story Rich"]
            }
        ];

        // Digital codes/subscriptions database
        const digitalCodesDatabase = [
            {
                id: 101,
                title: "Xbox Game Pass Ultimate - 1 Month",
                category: "Subscription",
                priceUSD: 16.99,
                priceSAR: 63.75,
                imageUrl: "https://compass-ssl.xbox.com/assets/17/6c/176c6d0a-f5a1-4d5d-8b0a-5b6c6e210a1b.jpg?n=XGP_GLP-Page-Hero-0_1083x1222_02.jpg",
                description: "Xbox Game Pass Ultimate includes over 100 high-quality games for console, PC, and Android mobile devices, online multiplayer, and an EA Play membership for one low monthly price.",
                type: "Subscription",
                duration: "1 Month",
                platform: "Xbox/PC"
            },
            {
                id: 102,
                title: "Xbox Game Pass Ultimate - 3 Months",
                category: "Subscription",
                priceUSD: 44.99,
                priceSAR: 168.75,
                imageUrl: "https://compass-ssl.xbox.com/assets/17/6c/176c6d0a-f5a1-4d5d-8b0a-5b6c6e210a1b.jpg?n=XGP_GLP-Page-Hero-0_1083x1222_02.jpg",
                description: "Xbox Game Pass Ultimate 3-month subscription. Play hundreds of high-quality games on console, PC, and cloud.",
                type: "Subscription",
                duration: "3 Months",
                platform: "Xbox/PC"
            }
        ];

        // Initialize local storage
        function initializeStorage() {
            if (!localStorage.getItem('users')) {
                const defaultUsers = [
                    {
                        id: 1,
                        email: "demo@gamehub.com",
                        password: "demo123",
                        name: "Demo User",
                        joinDate: "2023-01-15",
                        isAdmin: false,
                        isBanned: false,
                        orders: [
                            {
                                orderId: "ORD123456",
                                date: "2024-01-15",
                                items: [1, 41, 26],
                                total: 375.00,
                                status: "Completed"
                            }
                        ],
                        wishlist: [1, 41, 26]
                    },
                    {
                        id: 2,
                        email: "Admin@gamehub.com",
                        password: "Admin@30",
                        name: "Admin User",
                        joinDate: "2023-01-01",
                        isAdmin: true,
                        isBanned: false,
                        orders: [],
                        wishlist: []
                    }
                ];
                localStorage.setItem('users', JSON.stringify(defaultUsers));
            }

            if (!localStorage.getItem('games')) {
                localStorage.setItem('games', JSON.stringify(gameDatabase));
            }

            if (!localStorage.getItem('digitalCodes')) {
                localStorage.setItem('digitalCodes', JSON.stringify(digitalCodesDatabase));
            }

            if (!localStorage.getItem('orders')) {
                localStorage.setItem('orders', JSON.stringify([]));
            }

            if (!localStorage.getItem('settings')) {
                const defaultSettings = {
                    siteName: "GAMEHUB",
                    defaultCurrency: "USD",
                    defaultLanguage: "en",
                    taxRate: 15,
                    maintenanceMode: false,
                    paymentMethods: {
                        paypal: true,
                        creditCard: true,
                        crypto: false
                    },
                    minPurchase: 5.00,
                    currencyRate: 3.75
                };
                localStorage.setItem('settings', JSON.stringify(defaultSettings));
            }
        }

        // ===================== USER MANAGEMENT =====================
        function getCurrentUser() {
            const userEmail = localStorage.getItem('currentUser');
            if (!userEmail) return null;
            
            const users = JSON.parse(localStorage.getItem('users'));
            return users.find(user => user.email === userEmail);
        }

        function saveUser(user) {
            const users = JSON.parse(localStorage.getItem('users'));
            const index = users.findIndex(u => u.email === user.email);
            if (index !== -1) {
                users[index] = user;
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        function loginUser(email, password) {
            const users = JSON.parse(localStorage.getItem('users'));
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                if (user.isBanned) {
                    return { success: false, message: "Account is banned. Contact support." };
                }
                
                localStorage.setItem('currentUser', user.email);
                currentUser = user;
                updateUIForUser();
                return { success: true, user: user };
            }
            
            return { success: false, message: "Invalid email or password" };
        }

        function registerUser(name, email, password) {
            const users = JSON.parse(localStorage.getItem('users'));
            
            if (users.some(u => u.email === email)) {
                return { success: false, message: "Email already registered" };
            }
            
            const newUser = {
                id: users.length + 1,
                email: email,
                password: password,
                name: name,
                joinDate: new Date().toISOString().split('T')[0],
                isAdmin: false,
                isBanned: false,
                orders: [],
                wishlist: []
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            localStorage.setItem('currentUser', email);
            currentUser = newUser;
            updateUIForUser();
            
            return { success: true, user: newUser };
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            updateUIForUser();
            showPage('home');
            alert(getTranslation('menu-logout') + ' successful!');
        }

        // ===================== CURRENCY MANAGEMENT =====================
        function changeCurrency(currency) {
            currentCurrency = currency;
            localStorage.setItem('currentCurrency', currency);
            updateAllPrices();
            updateCurrencyDropdown();
        }

        function getPriceInCurrentCurrency(priceUSD) {
            if (currentCurrency === 'SAR') {
                return (priceUSD * conversionRate).toFixed(2);
            }
            return priceUSD.toFixed(2);
        }

        function getCurrencySymbol() {
            return currentCurrency === 'USD' ? '$' : 'ر.س';
        }

        function updateAllPrices() {
            // Update prices in games page
            if (document.getElementById('all-games-container')) {
                loadAllGames();
            }
            
            // Update prices in cart
            if (document.getElementById('cart-content')) {
                updateCartDisplay();
            }
            
            // Update currency dropdown
            updateCurrencyDropdown();
        }

        function updateCurrencyDropdown() {
            const currencyDropdown = document.getElementById('currencyDropdown');
            if (currencyDropdown) {
                currencyDropdown.innerHTML = `<i class="fas fa-money-bill-wave me-1"></i>${getTranslation('nav-currency')} (${getCurrencySymbol()})`;
            }
        }

        // ===================== LANGUAGE MANAGEMENT =====================
        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('currentLanguage', lang);
            
            // Update HTML direction for Arabic
            if (lang === 'ar') {
                document.body.dir = 'rtl';
                document.getElementById('html-lang').lang = 'ar';
            } else {
                document.body.dir = 'ltr';
                document.getElementById('html-lang').lang = 'en';
            }
            
            applyTranslations();
        }

        function getTranslation(key) {
            return translations[currentLanguage][key] || translations['en'][key] || key;
        }

        function applyTranslations() {
            // Apply translations to all elements with translation IDs
            Object.keys(translations[currentLanguage]).forEach(key => {
                const elements = document.querySelectorAll(`[id="${key}"]`);
                elements.forEach(element => {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translations[currentLanguage][key];
                    } else {
                        element.textContent = translations[currentLanguage][key];
                    }
                });
            });
            
            // Update dropdown labels
            updateCurrencyDropdown();
        }

        // ===================== CART MANAGEMENT =====================
        function addToCart(gameId) {
            if (!currentUser) {
                alert("Please login first to add items to cart");
                showPage('login');
                return;
            }
            
            const game = gameDatabase.find(g => g.id === gameId);
            if (!game) return;
            
            const cartItem = {
                id: gameId,
                title: game.title,
                priceUSD: game.priceUSD,
                quantity: 1
            };
            
            cart.push(cartItem);
            updateCartCount();
            saveCartToStorage();
            
            alert(`${game.title} added to cart!`);
        }

        function updateCartCount() {
            const count = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }

        function saveCartToStorage() {
            if (currentUser) {
                localStorage.setItem(`cart_${currentUser.email}`, JSON.stringify(cart));
            }
        }

        function loadCartFromStorage() {
            if (currentUser) {
                const savedCart = localStorage.getItem(`cart_${currentUser.email}`);
                cart = savedCart ? JSON.parse(savedCart) : [];
            } else {
                cart = [];
            }
            updateCartCount();
        }

        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cart-items-list');
            const cartEmpty = document.getElementById('cart-empty');
            const cartContent = document.getElementById('cart-content');
            
            if (!cartItemsList) return;
            
            if (cart.length === 0) {
                cartEmpty.style.display = 'block';
                cartContent.style.display = 'none';
                return;
            }
            
            cartEmpty.style.display = 'none';
            cartContent.style.display = 'block';
            
            let html = '';
            let subtotal = 0;
            
            cart.forEach(item => {
                const price = currentCurrency === 'USD' ? item.priceUSD : (item.priceUSD * conversionRate);
                const itemTotal = price * item.quantity;
                subtotal += itemTotal;
                
                html += `
                    <div class="cart-item">
                        <div class="row align-items-center">
                            <div class="col-md-2">
                                <img src="${gameDatabase.find(g => g.id === item.id)?.imageUrl || 'https://placehold.co/100x100/1a1a2e/fff?text=Game'}" 
                                     alt="${item.title}" class="img-fluid rounded">
                            </div>
                            <div class="col-md-4">
                                <h6>${item.title}</h6>
                                <small class="text-muted">${gameDatabase.find(g => g.id === item.id)?.category || 'Game'}</small>
                            </div>
                            <div class="col-md-2">
                                <span class="game-price">${getCurrencySymbol()}${getPriceInCurrentCurrency(item.priceUSD)}</span>
                            </div>
                            <div class="col-md-2">
                                <input type="number" class="form-control form-control-sm" 
                                       value="${item.quantity}" min="1" 
                                       onchange="updateCartQuantity(${item.id}, this.value)">
                            </div>
                            <div class="col-md-2 text-end">
                                <button class="btn btn-outline-danger btn-sm" onclick="removeFromCart(${item.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            cartItemsList.innerHTML = html;
            
            const tax = subtotal * 0.15;
            const total = subtotal + tax;
            
            document.getElementById('cart-subtotal').textContent = `${getCurrencySymbol()}${subtotal.toFixed(2)}`;
            document.getElementById('cart-tax').textContent = `${getCurrencySymbol()}${tax.toFixed(2)}`;
            document.getElementById('cart-total').textContent = `${getCurrencySymbol()}${total.toFixed(2)}`;
        }

        function updateCartQuantity(gameId, quantity) {
            const item = cart.find(item => item.id === gameId);
            if (item) {
                item.quantity = parseInt(quantity) || 1;
                saveCartToStorage();
                updateCartDisplay();
            }
        }

        function removeFromCart(gameId) {
            cart = cart.filter(item => item.id !== gameId);
            saveCartToStorage();
            updateCartDisplay();
            updateCartCount();
        }

        function proceedToCheckout() {
            if (cart.length === 0) {
                alert("Your cart is empty!");
                return;
            }
            
            showPage('checkout');
            updateCheckoutDisplay();
        }

        function updateCheckoutDisplay() {
            const checkoutItems = document.getElementById('checkout-items');
            let html = '';
            let subtotal = 0;
            
            cart.forEach(item => {
                const price = currentCurrency === 'USD' ? item.priceUSD : (item.priceUSD * conversionRate);
                const itemTotal = price * item.quantity;
                subtotal += itemTotal;
                
                html += `
                    <div class="d-flex justify-content-between mb-2">
                        <span>${item.title} x${item.quantity}</span>
                        <span>${getCurrencySymbol()}${itemTotal.toFixed(2)}</span>
                    </div>
                `;
            });
            
            checkoutItems.innerHTML = html;
            
            const tax = subtotal * 0.15;
            const total = subtotal + tax;
            
            document.getElementById('order-total').textContent = `${getCurrencySymbol()}${total.toFixed(2)}`;
            
            // Update card preview
            updateCardPreview();
        }

        // ===================== PAYMENT PROCESSING =====================
        function processPayment() {
            const cardNumber = document.getElementById('card-number').value.replace(/\s/g, '');
            const expiryDate = document.getElementById('expiry-date').value;
            const cvv = document.getElementById('cvv').value;
            const cardName = document.getElementById('card-name').value;
            
            // Validation
            if (!validateCardNumber(cardNumber)) {
                alert("Invalid card number. Must be 12-16 digits.");
                return false;
            }
            
            if (!validateExpiryDate(expiryDate)) {
                alert("Invalid expiry date. Must be in MM/YY format and not expired.");
                return false;
            }
            
            if (!validateCVV(cvv)) {
                alert("Invalid CVV. Must be 3 digits.");
                return false;
            }
            
            if (!validateCardName(cardName)) {
                alert("Invalid cardholder name. Must be 12-36 characters.");
                return false;
            }
            
            return true;
        }

        function validateCardNumber(number) {
            return /^\d{12,16}$/.test(number);
        }

        function validateExpiryDate(date) {
            if (!/^\d{2}\/\d{2}$/.test(date)) return false;
            
            const [month, year] = date.split('/').map(Number);
            const currentYear = new Date().getFullYear() % 100;
            const currentMonth = new Date().getMonth() + 1;
            
            if (month < 1 || month > 12) return false;
            if (year < currentYear) return false;
            if (year === currentYear && month < currentMonth) return false;
            
            return true;
        }

        function validateCVV(cvv) {
            return /^\d{3}$/.test(cvv);
        }

        function validateCardName(name) {
            return name.length >= 12 && name.length <= 36;
        }

        function completePayment() {
            if (!processPayment()) return;
            
            // Generate order
            const orderId = 'ORD' + Math.random().toString(36).substr(2, 9).toUpperCase();
            const orderDate = new Date().toISOString().split('T')[0];
            
            let subtotal = 0;
            cart.forEach(item => {
                const price = currentCurrency === 'USD' ? item.priceUSD : (item.priceUSD * conversionRate);
                subtotal += price * item.quantity;
            });
            
            const tax = subtotal * 0.15;
            const total = subtotal + tax;
            
            // Create order object
            const order = {
                orderId: orderId,
                date: orderDate,
                items: cart.map(item => item.id),
                gameKeys: cart.map(item => generateGameKey(item.title)),
                total: total,
                currency: currentCurrency,
                status: "Completed"
            };
            
            // Save order to user
            if (currentUser) {
                currentUser.orders.push(order);
                saveUser(currentUser);
                
                // Save to global orders
                const orders = JSON.parse(localStorage.getItem('orders'));
                orders.push({
                    ...order,
                    userId: currentUser.id,
                    userEmail: currentUser.email
                });
                localStorage.setItem('orders', JSON.stringify(orders));
            }
            
            // Clear cart
            cart = [];
            saveCartToStorage();
            updateCartCount();
            
            // Show success page
            showPaymentSuccess(order);
        }

        function showPaymentSuccess(order) {
            showPage('payment-success');
            
            // Update receipt
            document.getElementById('receipt-order-id-value').textContent = order.orderId;
            document.getElementById('receipt-date-value').textContent = new Date(order.date).toLocaleDateString();
            document.getElementById('receipt-customer-value').textContent = currentUser?.name || 'Guest';
            
            let receiptItemsHtml = '';
            let receiptCodesHtml = '';
            
            order.items.forEach((gameId, index) => {
                const game = gameDatabase.find(g => g.id === gameId);
                if (game) {
                    receiptItemsHtml += `
                        <div class="d-flex justify-content-between">
                            <span>${game.title}</span>
                            <span>${getCurrencySymbol()}${(currentCurrency === 'USD' ? game.priceUSD : game.priceUSD * conversionRate).toFixed(2)}</span>
                        </div>
                    `;
                    
                    receiptCodesHtml += `
                        <div class="mb-2">
                            <strong>${game.title}:</strong>
                            <div class="game-code">
                                <code>${order.gameKeys[index]}</code>
                                <button onclick="copyToClipboard('${order.gameKeys[index]}')" class="copy-btn">${getTranslation('copy')}</button>
                            </div>
                        </div>
                    `;
                }
            });
            
            document.getElementById('receipt-items').innerHTML = receiptItemsHtml;
            document.getElementById('receipt-game-codes').innerHTML = receiptCodesHtml;
            document.getElementById('receipt-total-value').textContent = `${getCurrencySymbol()}${order.total.toFixed(2)}`;
        }

        // ===================== WISHLIST MANAGEMENT =====================
        function toggleWishlist(gameId) {
            if (!currentUser) {
                alert("Please login to use wishlist");
                showPage('login');
                return;
            }
            
            const index = currentUser.wishlist.indexOf(gameId);
            if (index === -1) {
                currentUser.wishlist.push(gameId);
                alert("Added to wishlist!");
            } else {
                currentUser.wishlist.splice(index, 1);
                alert("Removed from wishlist!");
            }
            
            saveUser(currentUser);
            updateWishlistDisplay();
        }

        function isInWishlist(gameId) {
            return currentUser?.wishlist?.includes(gameId) || false;
        }

        function updateWishlistDisplay() {
            const wishlistGames = document.getElementById('wishlist-games');
            const wishlistEmpty = document.getElementById('wishlist-empty');
            
            if (!currentUser || currentUser.wishlist.length === 0) {
                wishlistEmpty.style.display = 'block';
                wishlistGames.innerHTML = '';
                return;
            }
            
            wishlistEmpty.style.display = 'none';
            
            let html = '';
            currentUser.wishlist.forEach(gameId => {
                const game = gameDatabase.find(g => g.id === gameId);
                if (!game) return;
                
                html += `
                    <div class="col-md-4 col-lg-3">
                        <div class="game-card h-100">
                            <div class="position-relative">
                                <span class="featured-badge">${game.category}</span>
                                <img src="${game.imageUrl}" alt="${game.title}" onerror="this.src='https://placehold.co/400x200/1a1a2e/fff?text=${encodeURIComponent(game.title)}'">
                            </div>
                            <div class="card-body d-flex flex-column">
                                <h5 class="game-title">${game.title}</h5>
                                <p class="text-muted small mb-2">${game.category} • ${game.developer}</p>
                                <div class="mt-auto d-flex justify-content-between align-items-center">
                                    <span class="game-price">${getCurrencySymbol()}${getPriceInCurrentCurrency(game.priceUSD)}</span>
                                    <div>
                                        <button onclick="addToCart(${game.id})" class="btn btn-game btn-sm me-1">Buy</button>
                                        <button onclick="toggleWishlist(${game.id})" class="btn btn-outline-danger btn-sm">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            wishlistGames.innerHTML = html;
        }

        // ===================== ADMIN FUNCTIONS =====================
        function adminLogin() {
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            
            const result = loginUser(email, password);
            if (result.success && result.user.isAdmin) {
                document.getElementById('admin-login-check').style.display = 'none';
                document.getElementById('admin-content').style.display = 'block';
                showAdminSection('analytics');
                updateAdminUI();
            } else {
                alert("Invalid admin credentials");
            }
        }

        function showAdminSection(section) {
            // Hide all sections
            document.querySelectorAll('.admin-section').forEach(s => {
                s.style.display = 'none';
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.admin-nav .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(`admin-${section}`).style.display = 'block';
            
            // Add active class to clicked nav link
            event.target.classList.add('active');
        }

        function updateAdminUI() {
            if (!currentUser?.isAdmin) return;
            
            // Load analytics
            loadAnalytics();
            
            // Load games management
            loadGamesManagement();
            
            // Load users management
            loadUsersManagement();
            
            // Load settings
            loadSettings();
        }

        function loadAnalytics() {
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const games = JSON.parse(localStorage.getItem('games')) || [];
            
            // Update stats
            let totalRevenue = 0;
            orders.forEach(order => {
                totalRevenue += order.total;
            });
            
            document.getElementById('total-revenue-amount').textContent = `$${totalRevenue.toFixed(2)}`;
            document.getElementById('total-orders-count').textContent = orders.length;
            document.getElementById('total-users-count').textContent = users.length;
            document.getElementById('total-games-count').textContent = games.length;
            
            // Load top games
            const gameSales = {};
            orders.forEach(order => {
                order.items.forEach(gameId => {
                    gameSales[gameId] = (gameSales[gameId] || 0) + 1;
                });
            });
            
            const topGamesList = document.getElementById('top-games-list');
            topGamesList.innerHTML = '';
            
            Object.entries(gameSales)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .forEach(([gameId, sales]) => {
                    const game = games.find(g => g.id == gameId);
                    if (game) {
                        const revenue = sales * game.priceUSD;
                        const row = `
                            <tr>
                                <td>${game.title}</td>
                                <td>${sales}</td>
                                <td>$${revenue.toFixed(2)}</td>
                            </tr>
                        `;
                        topGamesList.innerHTML += row;
                    }
                });
            
            // Load recent orders
            const recentOrdersList = document.getElementById('recent-orders-list');
            recentOrdersList.innerHTML = '';
            
            orders.slice(-5).reverse().forEach(order => {
                const user = users.find(u => u.email === order.userEmail);
                const row = `
                    <tr>
                        <td>${order.orderId}</td>
                        <td>${user?.name || 'Unknown'}</td>
                        <td>$${order.total.toFixed(2)}</td>
                        <td>${order.date}</td>
                    </tr>
                `;
                recentOrdersList.innerHTML += row;
            });
            
            // Create chart
            createSalesChart(orders);
        }

        function createSalesChart(orders) {
            const ctx = document.getElementById('salesChart').getContext('2d');
            
            // Group orders by date (last 30 days)
            const last30Days = [];
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                last30Days.push(date.toISOString().split('T')[0]);
            }
            
            const dailySales = last30Days.map(date => {
                const dayOrders = orders.filter(order => order.date === date);
                return dayOrders.reduce((sum, order) => sum + order.total, 0);
            });
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: last30Days.map(date => date.substring(5)),
                    datasets: [{
                        label: 'Daily Revenue ($)',
                        data: dailySales,
                        borderColor: '#ff0000',
                        backgroundColor: 'rgba(255, 0, 0, 0.1)',
                        borderWidth: 2,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#fff'
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#fff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#fff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function loadGamesManagement() {
            const games = JSON.parse(localStorage.getItem('games')) || [];
            const gamesList = document.getElementById('games-management-list');
            gamesList.innerHTML = '';
            
            games.forEach(game => {
                const row = `
                    <tr>
                        <td>${game.id}</td>
                        <td>${game.title}</td>
                        <td>${game.category}</td>
                        <td>$${game.priceUSD}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-warning me-1" onclick="editGame(${game.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteGame(${game.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
                gamesList.innerHTML += row;
            });
            
            // Add game form submission
            document.getElementById('add-game-form').onsubmit = function(e) {
                e.preventDefault();
                addNewGame();
            };
        }

        function addNewGame() {
            const title = document.getElementById('new-game-title').value;
            const category = document.getElementById('new-game-category').value;
            const priceUSD = parseFloat(document.getElementById('new-game-price').value);
            const imageUrl = document.getElementById('new-game-image').value;
            const description = document.getElementById('new-game-description').value;
            const developer = document.getElementById('new-game-developer').value;
            
            const games = JSON.parse(localStorage.getItem('games'));
            const newId = Math.max(...games.map(g => g.id)) + 1;
            
            const newGame = {
                id: newId,
                title: title,
                category: category,
                priceUSD: priceUSD,
                priceSAR: priceUSD * conversionRate,
                imageUrl: imageUrl || 'https://placehold.co/400x200/1a1a2e/fff?text=' + encodeURIComponent(title),
                description: description,
                releaseDate: new Date().toISOString().split('T')[0],
                developer: developer,
                publisher: developer,
                rating: "8/10",
                platforms: ["Windows"],
                tags: [category]
            };
            
            games.push(newGame);
            localStorage.setItem('games', JSON.stringify(games));
            
            alert("Game added successfully!");
            document.getElementById('add-game-form').reset();
            loadGamesManagement();
        }

        function deleteGame(gameId) {
            if (!confirm("Are you sure you want to delete this game?")) return;
            
            const games = JSON.parse(localStorage.getItem('games'));
            const filteredGames = games.filter(game => game.id !== gameId);
            localStorage.setItem('games', JSON.stringify(filteredGames));
            
            loadGamesManagement();
        }

        function loadUsersManagement() {
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const usersList = document.getElementById('users-management-list');
            usersList.innerHTML = '';
            
            users.forEach(user => {
                const totalSpent = user.orders.reduce((sum, order) => sum + order.total, 0);
                const row = `
                    <tr class="user-row">
                        <td>${user.id}</td>
                        <td>${user.email}</td>
                        <td>${user.name}</td>
                        <td>${user.joinDate}</td>
                        <td>${user.orders.length}</td>
                        <td>$${totalSpent.toFixed(2)}</td>
                        <td>
                            ${user.isBanned ? 
                                '<span class="banned-badge">Banned</span>' : 
                                '<span class="badge bg-success">Active</span>'
                            }
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-info me-1" onclick="viewUserDetails(${user.id})">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${user.isBanned ? 
                                `<button class="btn btn-sm btn-outline-success" onclick="toggleBanUser(${user.id}, false)">
                                    <i class="fas fa-check"></i>
                                </button>` :
                                `<button class="btn btn-sm btn-outline-danger" onclick="toggleBanUser(${user.id}, true)">
                                    <i class="fas fa-ban"></i>
                                </button>`
                            }
                        </td>
                    </tr>
                `;
                usersList.innerHTML += row;
            });
        }

        function toggleBanUser(userId, ban) {
            const users = JSON.parse(localStorage.getItem('users'));
            const user = users.find(u => u.id === userId);
            
            if (user) {
                user.isBanned = ban;
                localStorage.setItem('users', JSON.stringify(users));
                
                if (ban) {
                    alert(`User ${user.email} has been banned.`);
                } else {
                    alert(`User ${user.email} has been unbanned.`);
                }
                
                loadUsersManagement();
            }
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('settings'));
            
            document.getElementById('site-name').value = settings.siteName;
            document.getElementById('default-currency').value = settings.defaultCurrency;
            document.getElementById('default-language').value = settings.defaultLanguage;
            document.getElementById('tax-rate').value = settings.taxRate;
            document.getElementById('maintenance-mode').checked = settings.maintenanceMode;
            document.getElementById('paypal-enabled').checked = settings.paymentMethods.paypal;
            document.getElementById('credit-card-enabled').checked = settings.paymentMethods.creditCard;
            document.getElementById('crypto-enabled').checked = settings.paymentMethods.crypto;
            document.getElementById('min-purchase').value = settings.minPurchase;
            document.getElementById('currency-rate').value = settings.currencyRate;
            
            // Settings form submission
            document.getElementById('site-settings-form').onsubmit = function(e) {
                e.preventDefault();
                saveSiteSettings();
            };
            
            document.getElementById('payment-settings-form').onsubmit = function(e) {
                e.preventDefault();
                savePaymentSettings();
            };
        }

        function saveSiteSettings() {
            const settings = JSON.parse(localStorage.getItem('settings'));
            
            settings.siteName = document.getElementById('site-name').value;
            settings.defaultCurrency = document.getElementById('default-currency').value;
            settings.defaultLanguage = document.getElementById('default-language').value;
            settings.taxRate = parseFloat(document.getElementById('tax-rate').value);
            settings.maintenanceMode = document.getElementById('maintenance-mode').checked;
            
            localStorage.setItem('settings', JSON.stringify(settings));
            alert("Site settings saved successfully!");
        }

        function savePaymentSettings() {
            const settings = JSON.parse(localStorage.getItem('settings'));
            
            settings.paymentMethods.paypal = document.getElementById('paypal-enabled').checked;
            settings.paymentMethods.creditCard = document.getElementById('credit-card-enabled').checked;
            settings.paymentMethods.crypto = document.getElementById('crypto-enabled').checked;
            settings.minPurchase = parseFloat(document.getElementById('min-purchase').value);
            settings.currencyRate = parseFloat(document.getElementById('currency-rate').value);
            
            // Update conversion rate
            conversionRate = settings.currencyRate;
            
            localStorage.setItem('settings', JSON.stringify(settings));
            alert("Payment settings saved successfully!");
        }

        // ===================== UI UPDATES =====================
        function updateUIForUser() {
            const loggedInOnly = document.querySelectorAll('.logged-in-only');
            const loginMenuItem = document.getElementById('login-menu-item');
            const registerMenuItem = document.getElementById('register-menu-item');
            const adminOnly = document.querySelectorAll('.admin-only');
            
            if (currentUser) {
                // User is logged in
                loggedInOnly.forEach(el => el.style.display = 'block');
                loginMenuItem.style.display = 'none';
                registerMenuItem.style.display = 'none';
                
                // Check if user is admin
                if (currentUser.isAdmin) {
                    adminOnly.forEach(el => el.style.display = 'block');
                } else {
                    adminOnly.forEach(el => el.style.display = 'none');
                }
                
                // Update cart
                loadCartFromStorage();
                updateCartCount();
                
                // Update wishlist
                updateWishlistDisplay();
            } else {
                // User is not logged in
                loggedInOnly.forEach(el => el.style.display = 'none');
                adminOnly.forEach(el => el.style.display = 'none');
                loginMenuItem.style.display = 'block';
                registerMenuItem.style.display = 'block';
                
                // Clear cart
                cart = [];
                updateCartCount();
            }
        }

        function updateCardPreview() {
            const cardNumber = document.getElementById('card-number');
            const expiryDate = document.getElementById('expiry-date');
            const cardName = document.getElementById('card-name');
            
            if (cardNumber) {
                const previewNumber = document.getElementById('card-preview-number');
                if (cardNumber.value) {
                    const last4 = cardNumber.value.replace(/\s/g, '').slice(-4);
                    previewNumber.textContent = `**** **** **** ${last4}`;
                } else {
                    previewNumber.textContent = '**** **** **** ****';
                }
            }
            
            if (expiryDate) {
                const previewExpiry = document.getElementById('card-preview-expiry');
                previewExpiry.textContent = expiryDate.value || 'MM/YY';
            }
            
            if (cardName) {
                const previewName = document.getElementById('card-preview-name');
                previewName.textContent = cardName.value.toUpperCase() || 'CARDHOLDER NAME';
            }
        }

        // ===================== PAGE NAVIGATION =====================
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page-section');
            pages.forEach(page => page.classList.remove('active'));
            
            const activePage = document.getElementById(pageId);
            if (activePage) activePage.classList.add('active');
            window.scrollTo(0, 0);

            // Load appropriate content
            if (pageId === 'home') {
                loadGames('all');
                updateCategoryCounts();
            } else if (pageId === 'games') {
                loadAllGames();
                updateCategoryCounts();
            } else if (pageId === 'cart') {
                updateCartDisplay();
            } else if (pageId === 'wishlist') {
                updateWishlistDisplay();
            } else if (pageId === 'profile' && currentUser) {
                loadProfile();
            } else if (pageId === 'checkout') {
                updateCheckoutDisplay();
            } else if (pageId === 'admin') {
                if (!currentUser || !currentUser.isAdmin) {
                    // Show admin login
                    document.getElementById('admin-login-check').style.display = 'block';
                    document.getElementById('admin-content').style.display = 'none';
                } else {
                    // Show admin panel
                    document.getElementById('admin-login-check').style.display = 'none';
                    document.getElementById('admin-content').style.display = 'block';
                    showAdminSection('analytics');
                    updateAdminUI();
                }
            }
        }

        function loadProfile() {
            if (!currentUser) return;
            
            document.getElementById('profile-name').textContent = currentUser.name;
            document.getElementById('profile-email').textContent = currentUser.email;
            document.getElementById('profile-member-since').textContent = `Member since: ${currentUser.joinDate}`;
            document.getElementById('profile-fullname').textContent = currentUser.name;
            document.getElementById('profile-email-value').textContent = currentUser.email;
            document.getElementById('profile-joindate-value').textContent = currentUser.joinDate;
            document.getElementById('profile-totalorders-value').textContent = currentUser.orders.length;
            
            // Load orders
            const ordersList = document.getElementById('profile-orders-list');
            ordersList.innerHTML = '';
            
            currentUser.orders.forEach(order => {
                const row = `
                    <tr>
                        <td>${order.orderId}</td>
                        <td>${order.date}</td>
                        <td>${order.items.length} items</td>
                        <td>$${order.total.toFixed(2)}</td>
                        <td><span class="badge bg-success">${order.status}</span></td>
                    </tr>
                `;
                ordersList.innerHTML += row;
            });
        }

        // ===================== GAME DISPLAY FUNCTIONS =====================
        function loadGames(category = 'all') {
            const games = JSON.parse(localStorage.getItem('games')) || gameDatabase;
            let gamesToDisplay = category === 'all' 
                ? games.slice(0, 8)
                : games.filter(game => game.category === category).slice(0, 8);

            const container = document.getElementById('games-container');
            if (!container) return;
            
            container.innerHTML = '';

            gamesToDisplay.forEach(game => {
                const card = `
                    <div class="col-md-4 col-lg-3">
                        <div class="game-card h-100">
                            <div class="position-relative">
                                <span class="featured-badge">${game.category}</span>
                                <img src="${game.imageUrl}" alt="${game.title}" onerror="this.src='https://placehold.co/400x200/1a1a2e/fff?text=${encodeURIComponent(game.title)}'">
                            </div>
                            <div class="card-body d-flex flex-column">
                                <h5 class="game-title">${game.title}</h5>
                                <p class="text-muted small mb-2">${game.category} • ${game.developer}</p>
                                <p class="game-description small mb-2">${game.description.substring(0, 80)}...</p>
                                <div class="mt-auto d-flex justify-content-between align-items-center">
                                    <span class="game-price">${getCurrencySymbol()}${getPriceInCurrentCurrency(game.priceUSD)}</span>
                                    <div>
                                        <button onclick="addToCart(${game.id})" class="btn btn-game btn-sm me-1">Buy</button>
                                        <button onclick="toggleWishlist(${game.id})" class="btn ${isInWishlist(game.id) ? 'btn-outline-danger' : 'btn-outline-light'} btn-sm">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                container.innerHTML += card;
            });
        }

        function loadAllGames(filter = 'all') {
            const games = JSON.parse(localStorage.getItem('games')) || gameDatabase;
            let gamesToDisplay = filter === 'all' 
                ? games 
                : games.filter(game => game.category === filter);

            const container = document.getElementById('all-games-container');
            if (!container) return;
            
            container.innerHTML = '';

            gamesToDisplay.forEach(game => {
                const card = `
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="game-detail-card">
                            <div class="row">
                                <div class="col-md-4">
                                    <img src="${game.imageUrl}" alt="${game.title}" class="game-detail-img" onerror="this.src='https://placehold.co/300x400/1a1a2e/fff?text=${encodeURIComponent(game.title)}'">
                                </div>
                                <div class="col-md-8">
                                    <h5 class="game-title">${game.title}</h5>
                                    <div class="game-meta">
                                        <span><i class="fas fa-calendar"></i> ${game.releaseDate}</span> | 
                                        <span><i class="fas fa-user"></i> ${game.developer}</span> | 
                                        <span><i class="fas fa-star"></i> ${game.rating}</span>
                                    </div>
                                    <p class="game-description mb-2">${game.description}</p>
                                    <div class="mb-2">
                                        ${game.tags.map(tag => `<span class="badge bg-secondary me-1">${tag}</span>`).join('')}
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mt-3">
                                        <div>
                                            <span class="game-price">${getCurrencySymbol()}${getPriceInCurrentCurrency(game.priceUSD)}</span>
                                            <span class="price-badge ms-2">~$${game.priceUSD}</span>
                                        </div>
                                        <div>
                                            <button onclick="addToCart(${game.id})" class="btn btn-game btn-sm me-2">Add to Cart</button>
                                            <button onclick="toggleWishlist(${game.id})" class="btn ${isInWishlist(game.id) ? 'btn-outline-danger' : 'btn-outline-light'} btn-sm">
                                                <i class="fas fa-heart"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                container.innerHTML += card;
            });
        }

        function filterGames(category) {
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            loadAllGames(category === 'all' ? 'all' : category);
        }

        function searchGames() {
            const searchTerm = document.getElementById('gameSearch').value.toLowerCase();
            const games = JSON.parse(localStorage.getItem('games')) || gameDatabase;
            
            if (!searchTerm) {
                loadAllGames();
                return;
            }

            const filteredGames = games.filter(game => 
                game.title.toLowerCase().includes(searchTerm) || 
                game.description.toLowerCase().includes(searchTerm) ||
                game.tags.some(tag => tag.toLowerCase().includes(searchTerm))
            );

            const container = document.getElementById('all-games-container');
            container.innerHTML = '';

            if (filteredGames.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <h4 class="text-white">No games found</h4>
                        <p class="text-muted">Try searching for something else</p>
                    </div>`;
                return;
            }

            filteredGames.forEach(game => {
                const card = `
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="game-detail-card">
                            <div class="row">
                                <div class="col-md-4">
                                    <img src="${game.imageUrl}" alt="${game.title}" class="game-detail-img" onerror="this.src='https://placehold.co/300x400/1a1a2e/fff?text=${encodeURIComponent(game.title)}'">
                                </div>
                                <div class="col-md-8">
                                    <h5 class="game-title">${game.title}</h5>
                                    <div class="game-meta">
                                        <span><i class="fas fa-calendar"></i> ${game.releaseDate}</span> | 
                                        <span><i class="fas fa-user"></i> ${game.developer}</span> | 
                                        <span><i class="fas fa-star"></i> ${game.rating}</span>
                                    </div>
                                    <p class="game-description mb-2">${game.description.substring(0, 150)}...</p>
                                    <div class="d-flex justify-content-between align-items-center mt-3">
                                        <span class="game-price">${getCurrencySymbol()}${getPriceInCurrentCurrency(game.priceUSD)}</span>
                                        <button onclick="addToCart(${game.id})" class="btn btn-game btn-sm">Add to Cart</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                container.innerHTML += card;
            });
        }

        function updateCategoryCounts() {
            const games = JSON.parse(localStorage.getItem('games')) || gameDatabase;
            const categories = ['FPS', 'RPG', 'Action-Adventure', 'MMO', 'Arcade', 'Racing', 'Sports', 'Strategy', 'Horror'];
            
            categories.forEach(category => {
                const count = games.filter(game => game.category === category).length;
                const element = document.getElementById(`count-${category.toLowerCase().replace(' ', '-').replace('-adventure', '-action')}`);
                if (element) {
                    element.textContent = `${count} games`;
                }
            });
        }

        // ===================== HELPER FUNCTIONS =====================
        function generateGameKey(gameTitle) {
            const prefix = gameTitle.substring(0, 4).toUpperCase().replace(/\s/g, '');
            const random = Math.random().toString(36).substr(2, 9).toUpperCase();
            return `${prefix}-${random.substring(0, 4)}-${random.substring(4, 8)}-${random.substring(8, 12)}`;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }

        function editProfile() {
            const newName = prompt("Enter new name:", currentUser.name);
            if (newName && newName.trim() !== '') {
                currentUser.name = newName.trim();
                saveUser(currentUser);
                loadProfile();
                alert("Profile updated successfully!");
            }
        }

        // ===================== EVENT LISTENERS =====================
        document.addEventListener("DOMContentLoaded", () => {
            // Initialize storage
            initializeStorage();
            
            // Get current user
            currentUser = getCurrentUser();
            
            // Get settings
            const settings = JSON.parse(localStorage.getItem('settings'));
            
            // Set currency and language from settings or localStorage
            currentCurrency = localStorage.getItem('currentCurrency') || settings.defaultCurrency || 'USD';
            currentLanguage = localStorage.getItem('currentLanguage') || settings.defaultLanguage || 'en';
            conversionRate = settings.currencyRate || 3.75;
            
            // Apply language
            changeLanguage(currentLanguage);
            
            // Update UI for user
            updateUIForUser();
            
            // Load home page
            loadGames('all');
            updateCategoryCounts();
            
            // Setup event listeners
            document.getElementById('loginForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                
                const result = loginUser(email, password);
                if (result.success) {
                    alert("Login successful!");
                    showPage('home');
                } else {
                    alert(result.message);
                }
            });
            
            document.getElementById('registerForm')?.addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('register-name').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm').value;
                
                if (password !== confirmPassword) {
                    alert("Passwords do not match!");
                    return;
                }
                
                if (password.length < 6) {
                    alert("Password must be at least 6 characters!");
                    return;
                }
                
                const result = registerUser(name, email, password);
                if (result.success) {
                    alert("Registration successful! You are now logged in.");
                    showPage('home');
                } else {
                    alert(result.message);
                }
            });
            
            document.getElementById('payment-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                completePayment();
            });
            
            // Add real-time card preview
            const cardInputs = ['card-number', 'expiry-date', 'card-name'];
            cardInputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', updateCardPreview);
                    
                    // Format card number with spaces
                    if (id === 'card-number') {
                        input.addEventListener('input', function(e) {
                            let value = e.target.value.replace(/\s/g, '').replace(/\D/g, '');
                            if (value.length > 16) value = value.substring(0, 16);
                            e.target.value = value.replace(/(\d{4})/g, '$1 ').trim();
                        });
                    }
                    
                    // Format expiry date
                    if (id === 'expiry-date') {
                        input.addEventListener('input', function(e) {
                            let value = e.target.value.replace(/\D/g, '');
                            if (value.length >= 2) {
                                value = value.substring(0, 2) + '/' + value.substring(2, 4);
                            }
                            e.target.value = value;
                        });
                    }
                }
            });
            
            // Initialize tooltips
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
            
            console.log("GameHub Fully Loaded!");
        });
    </script>
</body>
</html>